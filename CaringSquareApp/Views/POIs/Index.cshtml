@model IEnumerable<CaringSquareApp.Models.POIs>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<br />
<br />
<br />
<br />
<div class="container">
    <h2>List of Attractions around Melbourne CBD</h2>
    <div id="map" style="height:300px"></div>
    <br />
    <br />

    @if (User.Identity.IsAuthenticated)
    {
        <div class="text-center text-lg-left">
            <h6 style:"font-weight: bold;"">
                Choose a Category to Filter your options:<input style="background-color: #94d16a; margin-left:10px; color: #000000;" type="submit" id="buttonedit" value="Choose a Category" onclick="window.location = 'POIs/Category';" class="btn btn-default" />
            </h6>
        </div>
    }

    @using (Html.BeginForm("AddFilter", "POIs", FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="true" name="category1">
            <label class="form-check-label" for="inlineCheckbox1">Cinema</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="true" name="category2">
            <label class="form-check-label" for="inlineCheckbox2">Shopping</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox3" value="true" name="category3">
            <label class="form-check-label" for="inlineCheckbox3">Sports</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox4" value="true" name="category4">
            <label class="form-check-label" for="inlineCheckbox4">Hangout</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox5" value="true" name="category5">
            <label class="form-check-label" for="inlineCheckbox5">Religious</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox6" value="true" name="category6">
            <label class="form-check-label" for="inlineCheckbox6">Museum</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox7" value="true" name="category7">
            <label class="form-check-label" for="inlineCheckbox7">Park</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox8" value="true" name="category8">
            <label class="form-check-label" for="inlineCheckbox8">Library</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox9" value="true" name="category9">
            <label class="form-check-label" for="inlineCheckbox9">Barbecue</label>
        </div>
        <input style="background-color: #94d16a; margin-left:10px; color: #000000;" type="submit" value="Add Filters" />
    }
    <table class="table" id="myTable">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.SubTheme)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Address)
                </th>

                <th style="display: none;">
                    @Html.DisplayNameFor(model => model.Latitude)
                </th>
                <th style="display: none;">
                    @Html.DisplayNameFor(model => model.Longitude)
                </th>

                <th>
                    @Html.DisplayNameFor(model => model.Category)
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {

                <tr class="coordinates">
                    <td class="description">
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.SubTheme)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Address)
                    </td>

                    <td class="latitude" style="display: none;">
                        @Html.DisplayFor(modelItem => item.Latitude)
                    </td>
                    <td class="longitude" style="display: none;">
                        @Html.DisplayFor(modelItem => item.Longitude)
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.Category)
                    </td>
                    <td>
                        @Html.ActionLink("Details", "Details", new { id = item.PlaceId, style = "font-weight: bold;" }) |
                        <button style="background-color: #ffffff; color: #000000;" class="mapcentre btn btn-default">View On Map</button>
                    </td>
                </tr>
            }
        </tbody>


    </table>
</div>

<script>
    window.onload = function () {
        $('#myTable').DataTable();
        $('#myTable tbody tr:even').css('background-color', '#94d16a');
        
        $('.mapcentre').on('click', function (e) {
            var placeName = $(this).closest('.coordinates').find('td').first().text().trim();
            var loc = locations.find(item => item.description === placeName) || { longitude: 0, latitude: 0};

            map.flyTo({
                center: [
                    loc.longitude,
                    loc.latitude
                ],
                essential: true // this animation is considered essential with respect to prefers-reduced-motion 
            });
          
            var coordinates = [loc.longitude, loc.latitude];
            new mapboxgl.Popup()
                .setLngLat(coordinates)
                .setHTML(placeName)
                .addTo(map);       
            
        $('html,body').animate({ scrollTop: 0 })

        })


    
    };



</script>

@section Scripts {
    @Scripts.Render("~/bundles/mapbox")
}
